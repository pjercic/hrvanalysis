'''
Created on Oct 21, 2019

@author: petar
'''

from hrvanalysis import remove_outliers, remove_ectopic_beats, interpolate_nan_values, get_time_domain_features,\
    get_jamzone_time_domain_features, get_frequency_domain_features, plot_psd, plot_poincare, plot
from build.lib.hrvanalysis.plot import plot_distrib
from hrvanalysis.plot import plot_timeseries

# rr_intervals_list contains integer values of RR-interval
#rr_intervals_list_1 = [1000, 1050, 1020, 1080, 3000, 1100, 1110, 1060]
rmssd_intervals_1 = [1575, 1591, 1594, 1594, 1609, 1625, 1630, 1628, 1634, 1637, 1652, 1667, 1667, 1691, 1700, 1685, 1670, 1667, 1667, 1667, 1682, 1679, 1667, 1676, 1682, 1682, 1685, 1700, 1679, 1700, 1703, 1703, 1703, 1703, 1712, 1720, 1720, 1720, 1723, 1735, 1735, 1735, 1748, 1748, 1755, 1755, 1761, 1766, 1764, 1757, 1757, 1764, 1764, 1766, 1769, 1761, 1761, 1761, 1761, 1755, 1757, 1761, 1761, 1764, 1778, 1766, 1775, 1780, 1780, 1775, 1778, 1780, 1786, 1817, 1817, 1800, 1800, 1803, 1803, 1814, 1814, 1822, 1822, 1825, 1830, 1864, 1871, 1871, 1887, 1887, 1887, 1895, 1895, 1895, 1892, 1895, 1913, 1918, 1918, 1921, 1907, 1910, 1913, 1913, 1855, 1855, 1857, 1855, 1855, 1855, 1848, 1855, 1864, 1863, 1868, 1868, 1868, 1871, 1871, 1871, 1873, 1873, 1871, 1879, 1879, 1879, 1880, 1884, 1892, 1889, 1892, 1892, 1900, 1903, 1900, 1900, 1903, 1897, 1897, 1895, 1889, 1884, 1871, 1864, 1864, 1871, 1857, 1857, 1757, 1755, 1757, 1757, 1757, 1748, 1738, 1744, 1744, 1746, 1746, 1752, 1752, 1744, 1741, 1741, 1741, 1741, 1741, 1746, 1746, 1741, 1738, 1738, 1738, 1744, 1746, 1746, 1738, 1729, 1735, 1735, 1748, 1766, 1755, 1755, 1757, 1744, 1726, 1723, 1723, 1718, 1700, 1685, 1676, 1648, 1639, 1643, 1646, 1646, 1652, 1652, 1634, 1637, 1634, 1628, 1634, 1634, 1616, 1612, 1591, 1591, 1587, 1591, 1594, 1587, 1578, 1575, 1578, 1572, 1572, 1575, 1559, 1575, 1575, 1584, 1575, 1572, 1581, 1609, 1609, 1625, 1622, 1612, 1619, 1625, 1622, 1622, 1630, 1628, 1639, 1648, 1634, 1634, 1628, 1619, 1619, 1628, 1625, 1625, 1587, 1584, 1587, 1584, 1587, 1572, 1572, 1562, 1559, 1552, 1513, 1503, 1503, 1483, 1493, 1493, 1487, 1487, 1530, 1536, 1513, 1513, 1526, 1526, 1526, 1738, 1755, 1780, 1780, 1772, 1772, 1772, 1772, 1772, 1772, 1755, 1755, 1755, 1755, 1755, 1752, 1748, 1748, 1748, 1752, 1752, 1746, 1746, 1748, 1741, 1732, 1732, 1729, 1732, 1714, 1726, 1726, 1726, 1729, 1729, 1729, 1729, 1729, 1729, 1772, 1769, 1769, 1766, 1775, 1789, 1789, 1789, 1789, 1789, 1794, 1803, 1825, 1830, 1828, 1836, 1830, 1836, 1836, 1852, 1852, 1855, 1857, 1864, 1871, 1873, 1873, 1873, 1884, 1880, 1887, 1871, 1871, 1855, 1844, 1844, 1864, 1844, 1838, 1848, 1847, 1844, 1844, 1857, 1863, 1863, 1852, 1876, 1876, 1876, 1876, 1880, 1880, 1895, 1889, 1897, 1897, 1895, 1907, 1905, 1910, 1913, 1916, 1923, 1907, 1907, 1913, 1921, 1921, 1921, 1916, 1916, 1921, 1918, 1913, 1916, 1926, 1930, 1921, 1977, 1967, 1972, 1980, 1977, 1952, 1952, 1929, 1936, 1942, 1930, 1930, 1936, 1936, 1942, 1944, 1929, 1926, 1929, 1929, 1930, 2005, 2010, 2010, 2002, 2002, 1995, 1992, 1992, 1989, 1989, 1997, 2002, 2005, 2014, 2022, 2022, 2022, 2027, 2030, 2032, 2027, 2020, 2032, 2030, 2030, 2002, 1997, 1997, 1982, 1987, 1982, 1792, 1766, 1741, 1741, 1741, 1746, 1748, 1748, 1748, 1748, 1752, 1772, 1775, 1775, 1775, 1775, 1778, 1772, 1778, 1772, 1772, 1772, 1769, 1766, 1766, 1769, 1775, 1780, 1782, 1782, 1778, 1780, 1772, 1775, 1786, 1786, 1786, 1792, 1786, 1825, 1847, 1805, 1811, 1817, 1814, 1805, 1805, 1805, 1805, 1805, 1803, 1797, 1775, 1772, 1764, 1764, 1761, 1755, 1755, 1757, 1761, 1746, 1746, 1772, 1775, 1766, 1766, 1811, 1817, 1817, 1830, 1864, 1895, 1876, 1987, 1985, 1972, 1970, 1977, 1980, 1975, 1975, 1975, 1975, 1952, 1967, 1967, 1967, 1967, 1960, 1957, 1947, 1942, 1939, 1939, 1947, 1930, 1930, 1918, 1916, 1913, 1900, 1900, 1897, 1897, 1889, 1889, 1884, 1889, 1892, 1889, 1892, 1892, 1897, 1889, 1892, 1884, 1838, 1876, 1892, 1926, 1944, 1942, 1942, 1934, 1930, 1930, 1930, 1936, 1936, 1918, 1926, 1926, 1926, 1939, 1934, 1857, 1857, 1860, 1954, 2025, 2025, 2025, 2027, 2027, 2027, 2022, 2022, 2017, 2010, 2002, 2002, 2012, 2010, 2005, 2007, 2010, 2010, 2010, 1995, 1995, 1997, 1992, 1989, 1989, 1989, 1987, 2000, 2005, 2007, 2014, 2012, 2035, 2042, 2035, 2037, 2045, 2045, 2042, 2027, 2027, 2027, 2049, 2049, 2049, 2057, 2057, 2071, 2076, 2117, 2124, 2145, 2138, 2135, 2133, 2131, 2131, 2135, 2135, 2131, 2131, 2131, 2145, 2147, 2145, 2145, 2114, 2100, 2098, 2093, 2088, 2088, 2102, 2088, 2088, 2088, 2086, 2086, 2081, 2078, 2088, 2093, 2093, 2093, 2095, 2093, 2098, 2095, 2093, 2093, 2100, 2098, 2076, 2076, 2076, 2076, 2035, 2035, 2017, 1985, 1944, 1832, 1830, 1832, 1828, 1825, 1880, 1873, 1871, 1876, 1887, 1930, 1930, 1930, 1930, 1929, 1944, 1944, 1944, 1952, 1954, 1962, 1952, 1952, 1957, 1952, 1957, 1957, 1962, 1970, 1972, 1972, 1982, 2025, 2035, 2042, 2047, 2049, 2049, 2047, 2047, 2042, 2035, 2027, 2025, 2025, 2010, 2017, 1980, 1962, 1934, 1910, 1910, 1918, 1923, 1929, 1930, 1923, 1916, 1916, 1913, 1918, 1907, 1907, 1905, 1897, 1897, 1897, 1884, 1880, 1786, 1705, 1714, 1718, 1712, 1712, 1720, 1720, 1712, 1714, 1714, 1714, 1714, 1697, 1703, 1703, 1714, 1712, 1712, 1712, 1714, 1714, 1714, 1714, 1723, 1718, 1718, 1718, 1714, 1700, 1700, 1691, 1691, 1667, 1655, 1661, 1661, 1652, 1655, 1655, 1694, 1694, 1694, 1667, 1667, 1667, 1673, 1673, 1657, 1648, 1597, 1581, 1591, 1591, 1616, 1616, 1622, 1657, 1673, 1673, 1670, 1667, 1646, 1643, 1643, 1643, 1643, 1637, 1646, 1661, 1661, 1661, 1648, 1655, 1655, 1657, 1673, 1712, 1720, 1723, 1718, 1709, 1709, 1712, 1709, 1712, 1709, 1705, 1697, 1694, 1709, 1700, 1700, 1697, 1694, 1694, 1694, 1694, 1694, 1694, 1694, 1694, 1694, 1694, 1694, 1697, 1700, 1703, 1700, 1637, 1637, 1639, 1630, 1622, 1568, 1556, 1556, 1556, 1559, 1546, 1549, 1552, 1543, 1536, 1539, 1536, 1546, 1546, 1543, 1549, 1549, 1546, 1546, 1549, 1536, 1483, 1466, 1459, 1453, 1456, 1459, 1463, 1466, 1466, 1470, 1473, 1476, 1480, 1483, 1476, 1476, 1470, 1470, 1466, 1473, 1476, 1470, 1463, 1466, 1473, 1476, 1480, 1487, 1490, 1490, 1497, 1500, 1507, 1497, 1503, 1507, 1513, 1517, 1523, 1526, 1533, 1523, 1526, 1533, 1539, 1533, 1536, 1539, 1543, 1546, 1552, 1559, 1565, 1562, 1572, 1549, 1556, 1562, 1565, 1565, 1572, 1578, 1581, 1575, 1581, 1587, 1594, 1600, 1609, 1612, 1622, 1630, 1630, 1637, 1643, 1643, 1648, 1648, 1657, 1594, 1594, 1603, 1612]
rmssd_intervals_2 = [1744, 1714, 1714, 1714, 1685, 1664, 1664, 1661, 1661, 1661, 1667, 1667, 1667, 1667, 1667, 1664, 1667, 1679, 1673, 1670, 1655, 1648, 1652, 1643, 1643, 1643, 1643, 1637, 1637, 1637, 1630, 1630, 1616, 1605, 1609, 1612, 1616, 1630, 1655, 1688, 1691, 1691, 1691, 1691, 1691, 1694, 1685, 1685, 1694, 1694, 1700, 1700, 1700, 1703, 1705, 1709, 1705, 1712, 1712, 1712, 1712, 1712, 1712, 1712, 1714, 1709, 1709, 1709, 1712, 1705, 1705, 1709, 1694, 1694, 1697, 1694, 1685, 1673, 1605, 1612, 1612, 1612, 1619, 1643, 1643, 1639, 1643, 1643, 1682, 1697, 1712, 1712, 1712, 1700, 1703, 1709, 1718, 1720, 1720, 1697, 1694, 1694, 1657, 1652, 1643, 1639, 1634, 1639, 1664, 1664, 1661, 1657, 1657, 1685, 1682, 1616, 1483, 1459, 1463, 1520, 1546, 1546, 1549, 1552, 1552, 1556, 1565, 1562, 1562, 1578, 1587, 1591, 1591, 1587, 1605, 1609, 1625, 1637, 1646, 1652, 1652, 1655, 1655, 1655, 1657, 1657, 1667, 1667, 1667, 1673, 1676, 1676, 1673, 1679, 1676, 1676, 1691, 1691, 1697, 1700, 1700, 1723, 1726, 1735, 1780, 1797, 1803, 1825, 1830, 1830, 1832, 1832, 1832, 1832, 1836, 1836, 1836, 1836, 1852, 1855, 1855, 1855, 1852, 1855, 1852, 1852, 1863, 1857, 1860, 1860, 1857, 1860, 1855, 1855, 1855, 1855, 1852, 1852, 1847, 1832, 1836, 1836, 1836, 1838, 1844, 1844, 1847, 1852, 1852, 1871, 1871, 1868, 1876, 1884, 1876, 1876, 1873, 1871, 1855, 1830, 1792, 1792, 1797, 1811, 1811, 1811, 1825, 1832, 1832, 1838, 1844, 1855, 1855, 1848, 1847, 1847, 1847, 1844, 1844, 1848, 1847, 1847, 1844, 1848, 1848, 1855, 1855, 1857, 1868, 1876, 1876, 1879, 1921, 1918, 1921, 1934, 1926, 1926, 1916, 1913, 1916, 1905, 1895, 1897, 1897, 1895, 1897, 1864, 1864, 1852, 1848, 1847, 1847, 1844, 1830, 1825, 1828, 1830, 1828, 1819, 1825, 1811, 1811, 1814, 1817, 1807, 1789, 1772, 1775, 1792, 1789, 1797, 1889, 1892, 1897, 1905, 1900, 1855, 1832, 1836, 1830, 1825, 1825, 1828, 1828, 1828, 1814, 1807, 1817, 1817, 1803, 1786, 1778, 1778, 1778, 1775, 1775, 1772, 1775, 1766, 1775, 1775, 1766, 1766, 1766, 1769, 1769, 1772, 1757, 1766, 1764, 1772, 1752, 1755, 1748, 1700, 1691, 1673, 1735, 1741, 1838, 1848, 1863, 1863, 1863, 1863, 1863, 1864, 1848, 1852, 1855, 1855, 1855, 1852, 1857, 1848, 1860, 1860, 1868, 1871, 1873, 1871, 1887, 1889, 1889, 1889, 1889, 1887, 1887, 1884, 1884, 1880, 1880, 1873, 1876, 1876, 1884, 1860, 1868, 1873, 1864, 1860, 1884, 1879, 1887, 1887, 1889, 1897, 1903, 1907, 1905, 1892, 1889, 1895, 1880, 1871, 1873, 1857, 1841, 1841, 1841, 1841, 1844, 1841, 1857, 1857, 1857, 1857, 1855, 1855, 1848, 1847, 1848, 1852, 1852, 1836, 1828, 1830, 1825, 1780, 1780, 1778, 1761, 1752, 1755, 1755, 1755, 1757, 1755, 1755, 1744, 1746, 1746, 1744, 1741, 1741, 1741, 1741, 1741, 1741, 1738, 1744, 1744, 1741, 1741, 1732, 1735, 1741, 1741, 1746, 1746, 1748, 1746, 1748, 1748, 1752, 1744, 1735, 1718, 1718, 1712, 1581, 1572, 1572, 1575, 1572, 1568, 1568, 1575, 1575, 1575, 1562, 1572, 1575, 1591, 1591, 1578, 1581, 1581, 1584, 1575, 1568, 1568, 1572, 1572, 1572, 1581, 1591, 1584, 1584, 1584, 1584, 1584, 1584, 1591, 1597, 1597, 1587, 1587, 1581, 1578, 1575, 1572, 1572, 1556, 1543, 1470, 1342, 1334, 1327, 1330, 1330, 1334, 1345, 1342, 1375, 1382, 1375, 1378, 1375, 1375, 1382, 1393, 1404, 1396, 1393, 1396, 1389, 1389, 1371, 1378, 1378, 1378, 1386, 1382, 1382, 1389, 1396, 1396, 1400, 1400, 1393, 1393, 1396, 1389, 1407, 1396, 1393, 1404, 1407, 1407, 1375, 1378, 1382, 1382, 1382, 1371, 1360, 1367, 1364, 1364, 1378, 1367, 1389, 1393, 1389, 1396, 1389, 1389, 1389, 1411, 1411, 1414, 1425, 1411, 1421, 1407, 1407, 1421, 1421, 1421, 1439, 1449, 1449, 1449, 1449, 1453, 1459, 1463, 1466, 1459, 1466, 1510, 1513, 1530, 1533, 1530, 1533, 1530, 1530, 1530, 1526, 1581, 1584, 1594, 1594, 1682, 1691, 1691, 1700, 1703, 1705, 1697, 1709, 1735, 1735, 1738, 1732, 1738, 1764, 1755, 1803, 1807, 1814, 1807, 1807, 1822, 1828, 1825, 1822, 1822, 1822, 1819, 1822, 1822, 1838, 1847, 1844, 1852, 1855, 1855, 1852, 1857, 1863, 1855, 1852, 1848, 1852, 1852, 1855, 1860, 1857, 1863, 1863, 1868, 1873, 1900, 1905, 1907, 1900, 1895, 1916, 1939, 1939, 1934, 1939, 1944, 1942, 1936, 1954, 1960, 1962, 1957, 1957, 1957, 1957, 1957, 1957, 1957, 1957, 1960, 1960, 1952, 1947, 1944, 1944, 1934, 1947, 1921, 1926, 1926, 1929, 1936, 1936, 1930, 1916, 1916, 1910, 1910, 1907, 1905, 1905, 1897, 1900, 1900, 1910, 1918, 1905, 1907, 1903, 1903, 1905, 1907, 1907, 1907, 1892, 1895, 1900, 1892, 1880, 1880, 1897, 1905, 1903, 1900, 1900, 1900, 1892, 1897, 1897, 1887, 1887, 1876, 1880, 1880, 1887, 1880, 1895, 1895, 1895, 1887, 1876, 1873, 1876, 1876, 1868, 1868, 1864, 1852, 1838, 1838, 1838, 1836, 1836, 1832, 1832, 1830, 1797, 1782, 1780, 1782, 1778, 1780, 1782, 1780, 1778, 1729, 1720, 1735, 1657, 1637, 1637, 1637, 1634, 1648, 1652, 1643, 1619, 1634, 1643, 1643, 1637, 1609, 1609, 1556, 1549, 1568, 1568, 1552, 1552, 1559, 1556, 1556, 1575, 1584, 1584, 1587, 1572, 1559, 1572, 1565, 1565, 1565, 1575, 1575, 1575, 1578, 1562, 1562, 1562, 1559, 1587, 1578, 1578, 1584, 1549, 1556, 1568, 1575, 1575, 1543, 1572, 1575, 1575, 1568, 1578, 1575, 1546, 1546, 1572, 1568, 1568, 1568, 1572, 1578, 1575, 1578, 1578, 1619, 1619, 1628, 1628, 1628, 1622, 1625, 1667, 1667, 1652, 1655, 1673, 1664, 1682, 1691, 1679, 1679, 1685, 1685, 1691, 1691, 1697, 1697, 1697, 1694, 1694, 1697, 1694, 1697, 1685, 1694, 1697, 1705, 1723, 1726, 1723, 1718, 1735, 1732, 1732, 1735, 1732, 1744, 1748, 1746, 1746, 1738, 1720, 1738, 1738, 1738, 1738, 1764, 1761, 1769, 1780, 1780, 1778, 1769, 1764, 1769, 1769, 1772, 1752, 1735, 1741, 1741, 1744, 1748, 1761, 1761, 1764, 1761, 1769, 1769, 1775, 1778, 1778, 1800, 1803, 1803, 1794, 1797, 1794, 1794, 1879, 1900, 1900, 1900, 1897, 1900, 1900, 1900, 1895, 1903, 1913, 1913, 1913, 1934, 1923, 1929, 1926, 1918, 1918, 1903, 1918, 1916, 1903, 1895, 1895, 1916, 1916, 1916, 1923, 1921, 1910, 1918, 1916, 1916, 1916, 1910, 1910, 1913, 1892, 1884, 1929, 1930, 1947, 1947, 1942, 1947, 1947, 1942, 1936, 1934, 1942, 1954, 1957, 1987, 1987, 2010, 2012, 2005, 2002, 2002, 1987, 1995, 2002, 1987, 1992, 1992, 1992, 1948, 1948, 1948, 1948, 1954, 1957, 1954, 1954, 1960, 1960, 1957, 1977, 1977, 1977, 1987, 1960, 1967, 1975, 1975, 1980, 1989, 2002, 2002, 2005, 1982, 1985, 1972, 1964, 1964, 1964, 1964, 1967, 1967, 1972, 2007, 2030, 2030, 2042, 2071, 2074, 2074, 2059, 2054, 2045, 2045, 2045, 2047, 2047, 2032, 2032, 2052, 2054, 2049, 2042, 2042, 2076, 2078, 2083, 2066, 2066, 2066, 2066, 2042, 2049, 2059, 2059, 2057, 2057, 2062, 2074, 2074, 2081, 2088, 2100, 2098, 2098, 2098, 2078, 2078, 2078, 2078, 2071, 2069, 2069, 2069, 2066, 2047, 2047, 2052, 2049, 2071, 2074, 2005, 1980, 1982, 1982, 1985, 1982, 1982, 1987, 1985, 1977, 1970, 1972, 1972, 1944, 1944, 1936, 1939, 1939, 1942, 1942, 1926, 1926, 1918, 1918, 1923, 1907, 1907, 1905, 1897, 1897, 1892, 1884, 1884, 1887, 1889, 1895, 1892, 1892, 1887, 1884, 1838, 1822, 1825, 1822, 1817, 1819, 1828, 1836, 1838, 1838, 1830, 1817, 1811, 1775, 1778, 1757, 1741, 1752, 1761, 1764, 1786, 1769, 1769, 1769, 1786, 1825, 1825, 1836, 1836, 1847, 1847, 1847, 1905, 1905, 1889, 1887, 1895, 1897, 1873, 1876, 1880, 1880, 1873, 1864, 1864, 1926, 1934, 1921, 1873, 1887, 1884, 1884, 1884, 1884, 1889, 1889, 1884, 1876, 1884, 1907, 1907, 1884, 1857, 1868, 1864, 1836, 1832, 1836, 1838, 1838, 1838, 1841, 1825, 1825, 1825, 1825, 1838, 1838, 1814, 1822, 1822, 1847, 1811, 1800, 1794, 1797, 1797, 1814, 1817, 1863, 2020, 2071, 2062, 2054, 2045, 2066, 2071, 2069, 2054, 2069, 2059, 2066, 2071, 2071, 2090, 2098, 2117, 2121, 2121, 2124, 2128, 2128, 2128, 2126, 2126, 2126, 2126, 2121, 2119, 2114, 2114, 2090, 2093, 2090, 2088, 2083, 2083, 2083, 2078, 2078, 2086, 2083, 2078, 2083, 2081, 2081, 2081, 2083, 2112, 2179, 2245, 2249, 2265, 2263, 2263, 2269, 2269, 2276, 2269, 2269, 2267, 2261, 2261, 2265, 2265, 2265, 2265, 2267, 2274, 2274, 2276, 2272, 2272, 2272, 2272, 2272, 2272, 2272, 2276, 2276, 2269, 2272, 2276, 2272, 2265, 2258, 2254, 2261, 2261, 2261, 2261, 2258, 2256, 2256, 2243, 2236, 2236, 2218, 2223, 2216, 2216, 2198, 2184, 2161, 2161, 2147, 2149, 2131, 2124, 2121, 2074, 2076, 2069, 2069, 2093, 2095, 2107, 2119, 2110, 2121, 2121, 2114, 2110, 2057, 2047, 2047, 2047, 2032, 2032, 2037, 2054, 2052, 2049, 2049, 2047, 2054, 2054, 2032, 2020, 2012, 2012, 2012, 2007, 2002, 2002, 2005, 2007, 2007, 2012, 2020, 2020, 2017, 2017, 2025, 2014, 2014, 2030, 2030, 2037, 2020, 2020, 2020, 2032, 2032, 2020, 2017, 1997, 1848, 1797, 1794, 1797, 1800, 1778, 1778, 1775, 1775, 1761, 1755, 1735, 1729, 1735, 1709, 1688, 1709, 1709, 1705, 1705, 1729, 1735, 1794, 1929, 1930, 1936, 1942, 1936, 1939, 1942, 1942, 1947, 1947, 1954, 1954, 1954, 1957, 1957, 1957, 1952, 1952, 1954, 1952, 1952, 1967, 1962, 1964, 1930, 1855, 1778, 1757, 1757, 1761, 1761, 1752, 1752, 1746, 1764, 1764, 1769, 1772, 1772, 1775, 1769, 1786, 1786, 1789, 1789, 1789, 1786, 1786, 1800, 1803, 1797, 1822, 1830, 1828, 1836, 1832, 1832, 1864, 1863, 1860, 1868, 1871, 1887, 1887, 1880, 1880, 1880, 1880, 1887, 1887, 1892, 1884, 1884, 1892, 1895, 1903, 1903, 1900, 1916, 1918, 1918, 1918, 1923, 1916, 1916, 1930, 1930, 1930, 1929, 1934, 1942, 1936, 1967, 1972, 1972, 1942, 1936, 1923, 1907, 1916, 1895, 1905, 1903, 1903, 1900, 1897, 1900, 1900, 1905, 1907, 1923, 1926, 1954, 1934, 1934, 1934, 1939, 1939, 1930, 1923, 1923, 1923, 1926, 1929, 1939, 1939, 1934, 1930, 1930, 1921, 1926, 1918, 1916, 1907, 1910, 1918, 1926, 1923, 1921, 1921, 1905, 1913, 1913, 1907, 1910, 1907, 1895, 1897, 1897, 1918, 1918, 1895, 1913, 1907, 1907, 1905, 1903, 1910, 1907, 1913, 1913, 1929, 1942, 1939, 1936, 1930, 1936, 1980, 2107, 2189, 2191, 2191, 2173, 2114, 1992, 2000, 2000, 2002, 2007, 2007, 2010, 2022, 2030, 2027, 2032, 2030, 2037, 2042, 2045, 2049, 2057, 2059, 2064, 2071, 2076, 2069, 2074, 2076, 2083, 2088, 2095, 2100, 2107, 2110, 2117, 2124, 2128, 2133, 2124, 2131, 2133, 2140, 2145, 2152, 2142, 2149, 2154, 2161, 2161, 2168, 2159, 2163, 2170, 2152, 2149, 2159, 2159, 2166, 2175, 2140, 2149, 2152, 2152, 2156, 2145, 2154, 2163, 2161, 2170, 2177, 2184, 2193, 2200, 2211, 2211, 2216, 2214, 2218, 2229, 2218, 2223, 2234, 2243, 2254, 2265, 2252, 2263, 2276, 2287, 2293, 2293, 2300, 2258, 2258, 2269, 2280]

# This remove outliers from signal
#rr_intervals_without_outliers = remove_outliers(rr_intervals=rr_intervals_list, low_rri=300, high_rri=2000)
# This replace outliers nan values with linear interpolation
#interpolated_rr_intervals = interpolate_nan_values(rr_intervals=rr_intervals_without_outliers, interpolation_method="linear")

# This remove ectopic beats from signal
#nn_intervals_list = remove_ectopic_beats(rr_intervals=interpolated_rr_intervals, method="malik")
# This replace ectopic beats nan values with linear interpolation
#interpolated_nn_intervals = interpolate_nan_values(rr_intervals=nn_intervals_list)

#Remove the outliers in the signal
rr_intervals_without_outliers = remove_outliers(rr_intervals=rmssd_intervals_1, low_rri=300, high_rri=3000)

# This replace outliers nan values with linear interpolation
interpolated_rr_intervals = interpolate_nan_values(rr_intervals=rr_intervals_without_outliers, interpolation_method="linear")

# This remove ectopic beats from signal
nn_intervals_list = remove_ectopic_beats(rr_intervals=interpolated_rr_intervals, method="malik")

# This replace ectopic beats nan values with linear interpolation
interpolated_nn_intervals = interpolate_nan_values(rr_intervals=nn_intervals_list)

# Get time-domain and frequency domain features from our signal
time_domain_features = get_jamzone_time_domain_features(nn_intervals_list)
freq_domain_features = get_frequency_domain_features(nn_intervals_list, method="lomb")

# Plot Power Spectral Density
plot_psd(nn_intervals_list, method="welch")
plot_distrib(nn_intervals_list)

# Plot Poincaré Plot for non linear domain features
plot_poincare(nn_intervals_list)
plot_poincare(nn_intervals_list, plot_sd_features=True)

# Plot others
plot_timeseries(nn_intervals_list);

print('END')